<!DOCTYPE html>
<html class="no-js" lang="en">
 
	
<!-- header::Start -->
	<head>
		<!-- Use Internet Explorer 9 Standards mode for Eclipse Browser Control - https://www.eclipse.org/swt/faq.php#browsernativeie and https://msdn.microsoft.com/en-us/library/jj676915%28v=vs.85%29.aspx -->
  		<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
		
		<!-- Next 2 http=equiv headers required to disable caching the Eclipse Browser Widget -->
		<meta http-equiv="Pragma" content="no-cache">
  		<meta http-equiv="Expires" content="-1">

		<meta charset="UTF-8"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<meta name="copyright" content="Copyright IBM Corporation 2014" />
		<meta name="abstract" content="IBM Integration Bus V10 Tutorial">
		<meta name="author" content="IBM">
		<meta name="description" content="IBM Integration Bus V10 Tutorial">
		<meta name="keywords" content="keywords" > 
		<meta name="robots" content="index,follow">
		<meta name="source" content="IBM Integration Bus V10 Tutorial" /> 
		
		<title>IBM Integration Bus V10 Tutorial</title>

    	<link rel="stylesheet" href="http://ot4i.github.io/iib-tutorials/css/main.css" />
		<link rel="stylesheet" href="http://ot4i.github.io/iib-tutorials/css/app.css" />
    	
		<script src="http://ot4i.github.io/iib-tutorials/js/json2.js"></script>
		<script src="http://ot4i.github.io/iib-tutorials/js/js2java.js"></script>
		<script src="http://ot4i.github.io/iib-tutorials/js/js2java_steps.js"></script>
		<script src="http://ot4i.github.io/iib-tutorials/js/vendor/modernizr.js"></script>
	</head>
<!-- header::End -->
<!-- body::Start -->
		<body>
  	<!-- body content here -->
	<div class="row">
	  <div class="small-12 medium-12 large-12 columns">
	    <p> </p>
	  </div>
	</div>
	<div class="row">
	  <div class="small-9 medium-9 large-9 columns">
	    <h4 class="title">(V10.0.0.3) Business transaction monitoring <action><div class="small radius button" id="stepsViewDetails" onclick="viewDetails()"> View Details</div> </action></h4>
	  </div>
	  <div class="small-3 medium-3 large-3 columns">
		<a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.msgbroker.helphome.doc/help_home_msgbroker.htm')" class="small right helplink">IBM Knowledge Center</a> 
	  </div>
	</div> 
	<hr>
	<div class="row">
		<div class="small-10 medium-10 large-10 columns">
		<h5> Learn how to monitor business transactions on IBM Integration Bus Version 10.0.0.3 </h5>
		</div>
		<div class="small-2 medium-2 large-2 columns">
			<div class="small radius button right" id="backToGallery" onclick="backToGallery()"> Back To Gallery
			</div>
		</div>
	</div>
	<div class="row">          
		  <div class="small-12 medium-12 large-12 columns">
			<ul class="tabs vertical"> 
				<li class="tab-title tab-title-small active">
				  <a href="javascript:;" onclick="show('panel21')">Create</a> 
				</li>
				<li class="tab-title tab-title-small">
				  <a href="javascript:;" onclick="show('panel31')">Prepare</a> 
				</li>
				<li class="tab-title tab-title-small">
				  <a href="javascript:;" onclick="show('panel41')">Run</a> 
				</li>
			</ul>
			<!-- editing -->
			<div class="tabs-content panel-thin-blue vertical"> 
		    	<div class="content active" id="panel21">
		    		
		    		<div class="small-10 medium-10 large-10 columns divider">
					
				      	<div class="row content-details">
					      	<h4></h4>
					        
						    
								<p> <h4>Import projects</h4> </p>
								
								
									
									<ul>
									
									
										<li> Click <span class="icon">Import</span> to import the implementation of a retail solution into your workspace.The solution contains the application <span class="application">BTM_RETAIL_APP</span> and the shared library <span class="library">BTM_RETAIL_SHARED_LIBRARY</span>.
										
										
											
											<ul>
											
												
													<li> <span class="msgflow">Main_Process_Order_Flow.msgflow</span> is the entry point of the application. It routes an incoming message to <span class="msgflow">Order_Item_Request_Flow.msgflow</span> that receives the request.</li>
												
													<li> The request is then processed by <span class="msgflow">Order_Item_Despatch_Flow.msgflow</span>. Finally, <span class="msgflow">Order_Item_Response_Flow.msgflow</span> sends a confirmation.</li>
												
													<li> Shared library <span class="library">BTM_RETAIL_SHARED_LIBRARY</span> contains the message model used by the solution.</li>
												
											
											</ul>
											
										
										</li>
									
										<li> All message flows have monitoring events configured on a number of their message nodes. <br>For this tutorial, all monitoring events use <code>$Root/XMLNSC/btm_retail/customerNumber</code> as the global correlator. To see an example, open <span class="msgflow">Main_Process_Order_Flow.msgflow</span>, select "Receive Retail Request" node, and click the Monitoring tab in the Properties view.
										
										</li>
									
										<li> BTM uses these correlators to group together events about the same order coming from different flows.
										
										</li>
									
									
									</ul>
									
								
							
								<p> <h4>Create queues</h4> </p>
								
							
								<p> The solution uses WebSphere MQ queues to route messages between the applications. </p>
								
								
									
									<ol>
									
									
										<li> Create the default IBM Integration Bus queues in WebSphere MQ by completing the following steps:
										
										
											
											<ol>
											
												
													<li> Open the IBM Integration Console.</li>
												
													<li> In the console window, type the following command:<br><code>server\sample\wmq\iib_createqueues <span class="varname">qmgr</span></code><br>where<br><span class="varname">qmgr</span> is the queue manager name.</li>
												
											
											</ol>
											
										
										</li>
									
										<li> Create the queues used by the MQ nodes in this tutorial by completing the following steps:
										
										
											
											<ol>
											
												
													<li> In the console window, type the following command:<br><code><span class="cmdname">runmqsc</span> <span class="varname"> qmgr {WorkspacePath}/BTM_RETAIL_APP/create_queues.mqsc</span></code><br>where<br><span class="varname">qmgr</span> is the queue manager name and <span class="varname">WorkspacePath</span> is the location of your current Toolkit workspace.</li>
												
											
											</ol>
											
										
										</li>
									
										<li> Associate the default integration node with the queue manager by completing the following steps:
										
										
											
											<ol>
											
												
													<li> In the console window, stop the default integration node by typing the following command:<br><code><span class="cmdname">mqsistop</span> -i <span class="varname">TESTNODE_userid</span></code></li>
												
													<li> Associate the queue manager with the default integration node, <span class="varname">TESTNODE_userid</span> by typing the following command:<br><code><span class="cmdname">mqsichangebroker</span> <span class="varname">TESTNODE_userid</span> -q <span class="varname">qmgr</span></code><br>where<br><span class="varname">qmgr</span> is the queue manager name</li>
												
													<li> Start the default integration node by typing the following command:<br><code><span class="cmdname">mqsistart</span> <span class="varname">TESTNODE_userid</span></code></li>
												
											
											</ol>
											
										
										</li>
									
									
									</ol>
									
								
							
								<p> <h4>Create database</h4> </p>
								
							
								<p> The solution requires a database to record and store business transaction data. </p>
								
								
									
									<ol>
									
									
										<li> Open a DB2 command window and run the following command to create the MBRECORD database and monitoring events tables:<br><code>db2 -tvf <span class="varname">{IIBInstallDir}</span>/server/ddl/db2/DataCaptureSchema.sql</code><br>where<br><span class="varname">IIBInstallDir</span> is the location of the IBM Integration Bus installation.<br><b>Note:</b>To customize the database or schema name used by business transaction monitoring, edit the <span class="filepath">DataCaptureSchema.sql</span> file before running the command.
										
										</li>
									
										<li> In the DB2 command window, run the following command to create the tables for recording and storing business transaction data:<br><code>db2 <span class="varname">IIBInstallDir</span>/server/ddl/db2/BusinessCaptureSchema.sql</code><br><b>Note:</b> If you modified the name of the database in the previous step, you must update the database name in the <span class="filepath">BusinessCaptureSchema.sql</span> file before you run the command.
										
										</li>
									
										<li> Define <span class="userinput">MBRECORD</span> as the ODBC data source name (DSN) for the database MBRECORD.<br>Follow the link <span class="uicontrol">Enabling ODBC connections to the databases</span> in the <span class="uicontrol">Find out more</span> section below for instructions on configuring an ODBC data source for your operating system.<br><b>Note:</b> If you modified the name of the database in the previous steps, use the same name for your DSN name in this step.
										
										</li>
									
										<li> Set a user ID and password for the integration node to use when connecting to the database by completing the following steps:
										
										
											
											<ol>
											
												
													<li> Open the IBM Integration Console.</li>
												
													<li> In the console window, run the following command:<br><code><span class="cmdname">mqsisetdbparms</span> <span class="varname">TESTNODE_userid</span> -n MBRECORD -u <span class="varname">id</span> -p <span class="varname">password</span></code><br>where<br><span class="varname">TESTNODE_userid</span> is the default integration node<br><span class="varname">id</span> and <span class="varname">password</span> are the user ID and password that are used to connect to the MBRECORD database<br></li>
												
													<li> Optional: Verify the user id and password for the database is set correctly by running the following command:<br><code><span class="cmdname">mqsireportdbparms</span> <span class="varname">TESTNODE_userid</span> -n MBRECORD -u <span class="varname">id</span> -p <span class="varname">password</span></code></li>
												
											
											</ol>
											
										
										</li>
									
										<li> Restart the integration node by running the following commands in the console window:
										
										
											
											<ol>
											
												
													<li> <code><span class="cmdname">mqsistop</span> <span class="varname">TESTNODE_userid</span></code></li>
												
													<li> (After the integration node is stopped.) <code><span class="cmdname">mqsistart</span> <span class="varname">TESTNODE_userid</span></code></li>
												
											
											</ol>
											
										
										</li>
									
										<li> Optional: Test the connection to the database MBRECORD by running the following command in the console window:<br><code><span class="cmdname">mqsicvp</span> <span class="varname">TESTNODE_userid</span> -n MBRECORD</code>
										
										</li>
									
									
									</ol>
									
								
							
						</div>
						
						<div class="row content-details">
							<h4>Find out more</h4>
							<ul>
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/Fss26030_.htm')" title="Knowledge Center link to Correlation and monitoring events">Correlation and monitoring events</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/ac60381_.htm')" title="Knowledge Center link to Configuring monitoring event sources by using monitoring properties">Configuring monitoring event sources by using monitoring properties</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/ah09090_.htm')" title="Knowledge Center link to Creating the default IBM Integration Bus queues on a WebSphere MQ queue manager">Creating the default IBM Integration Bus queues on a WebSphere MQ queue manager</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bj23076_.htm')" title="Knowledge Center link to Creating a business transaction definition">Creating a business transaction definition</a> </li>
							   	
							
							</ul>
						</div>
						
					</div>
					
					<div class="small-2 medium-2 large-2 columns">
					
					
					<h4 class="tkaction"><a href="javascript:;" onclick="importArtifacts(); openResource('Main_Process_Order_Flow')"> Import <img class="icon-image" src="http://ot4i.github.io/iib-tutorials/images/icons/ibmdesign/back-right-previous_128-orange.png"></a></h4>
										
				    </div>
					
		    	</div>
		    	<div class="content" id="panel31">
					
					<div class="small-12 medium-12 large-12 columns">
					
						<div class="row content-details">
						  	<h4></h4>
						    
						    
								<p> <h4>Deploy projects</h4> </p>
								
								
									
									<ol>
									
									
										<li> Drag and drop <span class="library">BTM_RETAIL_SHARED_LIBRARY</span> and <span class="application">BTM_RETAIL_APP</span> onto an integration server of <span class="varname">TESTNODE_userid</span>.
										
										</li>
									
									
									</ol>
									
								
							
								<p> <h4>Create a business transaction definition</h4> </p>
								
								
									
									<ol>
									
									
										<li> Right-click on <span class="varname">TESTNODE_userid</span> in the Integration Nodes view and select <span class="uicontrol">Start Web User Interface</span>.
										
										</li>
									
										<li> Create a business transaction definition in the web user interface by completing the following steps:
										
										
											
											<ol>
											
												
													<li> Expand <span class="uicontrol">Business -> Business Transactions</span>.</li>
												
													<li> Select <span class="uicontrol">Create</span> from the menu to create a new business transaction.</li>
												
													<li> Enter <span class="userinput">RetailOrderBTD</span> and click <span class="uicontrol">OK</span>.</li>
												
											
											</ol>
											
										
										</li>
									
										<li> Add message flows to the business transaction definition by completing the following steps:
										
										
											
											<ol>
											
												
													<li> In the <span class="uicontrol">Define</span> tab of <span class="userinput">RetailOrderBTD</span>, click <span class="uicontrol">Add flow</span> to select the message flows that make up this business transaction.</li>
												
													<li> In the "Add message flows" dialog , click <span class="uicontrol">Select application</span>, then click the dropdown menu and select <span class="application">BTM_RETAIL_APP</span>.</li>
												
													<li> Click <span class="uicontrol">Add</span> to add all the message flows in this application to <span class="userinput">RetailOrderBTD</span>.</li>
												
													<li> Observe that <span class="msgflow">Main_Process_Order_Flow.msgflow</span>, <span class="msgflow">Order_Item_Request_Flow.msgflow</span>, <span class="msgflow">Order_Item_Despatch_Flow.msgflow</span> and <span class="msgflow">Order_Item_Response_Flow.msgflow</span> are added to the <span class="uicontrol">Business Transaction</span> section.<br>The <span class="icon">warning</span> icon indicates that no start and end events have been defined for this business transaction.</li>
												
											
											</ol>
											
										
										</li>
									
										<li> Select the monitoring events that indicate the start, end, and failure of the business transaction definition by completing the following steps in the <span class="uicontrol">Business Transaction Event Definitions</span> section:
										
										
											
											<ol>
											
												
													<li> Expand <span class="msgflow">Main_Process_Order_Flow.msgflow</span>, flag the "Retail request received" event as the <span class="uicontrol">Start</span> event.</li>
												
													<li> Expand <span class="msgflow">Order_Item_Request_Flow.msgflow</span>, flag the "Order Item Request Received" event as the <span class="uicontrol">Progress</span> event.</li>
												
													<li> Expand <span class="msgflow">Order_Item_Despatch_Flow.msgflow</span>, flag the "Item Despatched" event as the <span class="uicontrol">Progress</span> event.</li>
												
													<li> Expand <span class="msgflow">Order_Item_Response_Flow.msgflow</span>, flag the "Confirm Item Ordered" event as the <span class="uicontrol">End</span> event.</li>
												
											
											</ol>
											
										
										</li>
									
										<li> Save <span class="userinput">RetailOrderBTD</span>.
										
										</li>
									
									
									</ol>
									
								
							
								<p> <h4>Configure the database to be used for the business transaction definition</h4> </p>
								
								
									
									<ol>
									
									
										<li> Select the <span class="uicontrol">Configure</span> tab. Note that <span class="resource">RetailOrderBTD</span> is not yet configured with a data source.
										
										</li>
									
										<li> Click <span class="uicontrol">Click here to specify a data source name</span> and select the data source name <span class="userinput">MBRECORD</span> from the dropdown menu.
										
										</li>
									
										<li> Click <span class="uicontrol">Save</span> to save the datasource name, and click <span class="uicontrol">Resume editing of business transaction RetailOrderBTD</span> to return to the <span class="uicontrol">Configure</span> tab.<br><b>Note:</b> MBRecord will be used to record all the business transactions for this integration node.
										
										</li>
									
									
									</ol>
									
								
							
								<p> <h4>Start monitoring the message flows</h4> </p>
								
								
									
									<ol>
									
									
										<li> In the web user interface, expand <span class="uicontrol">Servers -> <span class="varname">server</span> -> Applications -> BTM_RETAIL_APP</span><br>where<br><span class="varname">server</span> is the integration server where the <span class="application">BTM_RETAIL_APP</span> application is deployed.
										
										</li>
									
										<li> Click the dropdown menu for the <span class="uicontrol">BTM_RETAIL_APP</span> application and select <span class="uicontrol">Start flow monitoring</span>.
										
										</li>
									
									
									</ol>
									
								
							
						</div>
						
						<div class="row content-details">
							<h4>Find out more</h4>
							<ul>
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/ah14440_.htm')" title="Knowledge Center link to Enabling ODBC connections to the databases">Enabling ODBC connections to the databases</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bj28410_.htm')" title="Knowledge Center link to Creating and configuring a DB2 database for recording data">Creating and configuring a DB2 database for recording data</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bj28420_.htm')" title="Knowledge Center link to Creating and configuring an Oracle database for recording data">Creating and configuring an Oracle database for recording data</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bn28810_.htm')" title="Knowledge Center link to DataCapture policy">DataCapture policy</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bj23094_.htm')" title="Knowledge Center link to Updating the default DataCapture policy">Updating the default DataCapture policy</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bj23076_.htm')" title="Knowledge Center link to Creating a business transaction definition">Creating a business transaction definition</a> </li>
							   	
							
							</ul>
						</div>
							
					</div>
					
		    	</div>
		    	<div class="content" id="panel41">
		    		
		    		<div class="small-10 medium-10 large-10 columns divider">
					
				    	<div class="row content-details">
					      	<h4></h4>
					        
						    
								<p> <h4>Run Main_Process_Order_Flow in the flow exerciser</h4> </p>
								
								
									
									<ol>
									
									
										<li> In the <span class="application">BTM_RETAIL_APP</span>, open the <span class="msgflow">Main_Process_Order_Flow</span> message flow.
										
										</li>
									
										<li> Click the Flow Exerciser icon <img src="http://ot4i.github.io/ot4i.tutorials//dist/images/icons/iib/startFlowExerciser.png" alt> to start recording the message path through the flow.
										
										</li>
									
										<li> Click the Send Message icon <img src="http://ot4i.github.io/ot4i.tutorials/dist/images/icons/iib/sendMessage.png" alt> to select a message to send to the flow and choose <span class="uicontrol">Chocolate Order</span>. Note the "requestType" is "orderItem" and "customerNumber" is "5555". Click <span class="uicontrol">Send</span>.
										
										</li>
									
										<li> After the response message is received, the message path is highlighted on the message flow. You may click on any connection to see the message that passed through that connection.
										
										</li>
									
										<li> Click the Send Message icon <img src="http://ot4i.github.io/ot4i.tutorials/dist/images/icons/iib/sendMessage.png" alt> again and choose <span class="uicontrol">Coffee Order</span>. Note the "requestType" is "orderItem" and "customerNumber" is "5670". Click <span class="uicontrol">Send</span>.
										
										</li>
									
										<li> Click the Send Message icon <img src="http://ot4i.github.io/ot4i.tutorials/dist/images/icons/iib/sendMessage.png" alt> again and choose <span class="uicontrol">Tea Order</span>. Note the "requestType" is "orderItem" and "customerNumber" is "4785". Click <span class="uicontrol">Send</span>.
										
										</li>
									
									
									</ol>
									
								
							
								<p> All 3 transactions were processed by the message flows in <span class="application">BTM_RETAIL_APP</span> and captured by <span class="resource">RetailOrderBTD</span>. You can now view the results in the web user interface. </p>
								
							
								<p> <h4>View the instances of RetailOrderBTD</h4> </p>
								
								
									
									<ol>
									
									
										<li> Open the web user interface.
										
										</li>
									
										<li> Expand <span class="uicontrol">Business -> Business Transactions</span>, select <span class="uicontrol">RetailOrderBTD</span>, and then select the <span class="uicontrol">View</span> tab.
										
										</li>
									
										<li> Click <span class="uicontrol">Refresh</span> in the <span class="uicontrol">All instsances of RetailOrderBTD</span> section. 3 instances, identified by the global transaction ID "customerNumber", are shown. All instances have the status of "Ended".
										
										</li>
									
										<li> Click an instance. The 4 associated events, "Retail request received", "Order Item Request Received", "Item Despatched", "Confirm Item Ordered", and their corresponding details are shown in the <span class="uicontrol">Events</span> section.
										
										</li>
									
										<li> Optionally, to show only the instances with a specified global transaction ID, or those that have a particular status, click <span class="uicontrol">Filter</span> in the <span class="uicontrol">All instsances of RetailOrderBTD</span> section to specify the filtering criteria.
										
										</li>
									
									
									</ol>
									
								
							
						</div>
						
						<div class="row content-details"> 	
							<h4>Find out more</h4>
							<ul>
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bj23077_.htm')" title="Knowledge Center link to Viewing the results of business transaction monitoring">Viewing the results of business transaction monitoring</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bj23078_.htm')" title="Knowledge Center link to Filtering business transaction monitoring information">Filtering business transaction monitoring information</a> </li>
							   	
							
							</ul>
						</div>
							
					</div>
					
					<div class="small-2 medium-2 large-2 columns">
					
					
					
					
					
					<h4 class="tkaction"><a href="javascript:;" onclick="cleanUp()" title="Clean up and remove any changes in your workspace made by the tutorial."> Clean Up <img class="icon-image" src="http://ot4i.github.io/iib-tutorials/images/icons/ibmdesign/close-cancel-error_128-red.png"></a></h4>
				    
					
				    </div>
					
				</div>	
			</div> <!-- tab-content -->
		</div> <!-- columns -->
	  </div> <!-- row --></body>
		<script src="http://ot4i.github.io/iib-tutorials/js/vendor/jquery.js"></script>
		<script src="http://ot4i.github.io/iib-tutorials/js/vendor/foundation.min.js"></script>
		<script src="http://ot4i.github.io/iib-tutorials/js/main.js"></script>
	</body>
<!-- body::End -->

</html>
